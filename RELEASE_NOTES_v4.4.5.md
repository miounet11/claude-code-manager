# Miaoda v4.4.5 发布说明

发布日期：2025-07-28

## 🎯 版本亮点

本版本进一步增强了环境检测功能，解决了打包应用中无法正确识别已安装工具的问题，特别优化了 Node.js 和 Claude CLI 的检测逻辑。

## 🚀 新增功能

### 1. 环境诊断工具
- 🔍 新增"环境诊断"按钮，生成详细的环境检测报告
- 📊 诊断报告保存到桌面，包含完整的环境信息
- 🗂️ 可在 Finder 中直接查看诊断报告文件

### 2. 增强的环境检测
- 🔧 使用 `launchctl` 获取用户真实的 PATH 环境变量
- 🛠️ 支持从 shell 配置文件读取 PATH 设置
- 📦 自动构建包含所有常见路径的完整 PATH

## 💎 优化改进

### 1. Node.js 检测优化
- ✅ 自动检测 Electron 内置的 Node.js 版本
- 🔍 扩展搜索路径，支持 nvm、n 等版本管理器
- 🏠 支持用户自定义安装路径

### 2. Claude CLI 检测优化
- 📍 搜索更多可能的安装位置
- 🔎 包括用户特定路径（如 ~/Documents/claude code/）
- ✨ 即使无法执行版本命令，文件存在也认为已安装

### 3. 搜索路径扩展
- 添加 Homebrew（Intel 和 Apple Silicon）路径
- 添加 MacPorts 路径
- 添加用户级安装目录（~/.local/bin、~/bin）
- 动态获取 npm 全局安装路径

## 🐛 修复问题

1. **修复打包应用 PATH 受限问题**
   - 解决了 macOS 打包应用中 PATH 环境变量被限制的问题
   - 确保能够访问系统完整的 PATH

2. **修复命令检测失败问题**
   - 改进了命令检测逻辑，支持多种备用检测方法
   - 提高了在受限环境中的检测成功率

## 📚 技术细节

### 环境检测流程
```
1. 增强 PATH 环境变量
   ├── launchctl getenv PATH
   ├── /usr/libexec/path_helper
   └── 手动构建常见路径

2. 命令检测方法
   ├── command -v（POSIX 标准）
   ├── which 命令
   ├── 直接执行测试
   └── 文件系统搜索

3. 特殊处理
   ├── Electron 内置 Node.js
   ├── npm 全局包路径
   └── 版本管理器路径
```

## 🔧 使用建议

如果环境检测仍有问题：
1. 点击环境检测面板中的"环境诊断"按钮
2. 查看生成的诊断报告了解详细信息
3. 报告中包含所有搜索路径和检测结果

## 📋 已知问题

暂无

## 🙏 致谢

感谢用户反馈的环境检测问题，帮助我们不断改进产品体验。

---

**下载地址**：[GitHub Releases](https://github.com/miounet11/claude-code-manager/releases/tag/v4.4.5)