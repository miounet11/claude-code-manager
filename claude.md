# Miaoda - Claude Code Manager 开发规范文档

## 项目概述

Miaoda 是一个专业的 Claude Code 部署和管理工具，提供图形化界面来管理 Claude Code 的配置和环境。本项目基于 Electron 框架开发，采用 PuTTY 风格的界面设计，为用户提供简洁高效的管理体验。

## 技术架构

### 前端技术栈
- **框架**: Electron (最新稳定版)
- **UI 设计**: 原生 HTML/CSS/JavaScript
- **终端模拟**: xterm.js
- **样式主题**: PuTTY 风格黑色主题

### 后端技术栈
- **运行时**: Node.js 16+
- **进程管理**: child_process
- **数据存储**: electron-store
- **打包工具**: electron-builder

### 核心依赖
- electron
- xterm.js
- xterm-addon-fit
- electron-store
- electron-builder

## 开发规范

### 代码风格
- 使用 ES6+ 语法
- 严格模式 ('use strict')
- 函数式编程优先
- 模块化设计

### 命名规范
- 文件名: 小写字母，使用连字符分隔 (kebab-case)
- 变量/函数: 驼峰命名法 (camelCase)
- 类名: 帕斯卡命名法 (PascalCase)
- 常量: 全大写，下划线分隔 (UPPER_SNAKE_CASE)

### 项目结构
```
miaoda/
├── src/
│   ├── main/              # 主进程代码
│   │   ├── index.js       # 主进程入口
│   │   ├── config.js      # 配置管理
│   │   ├── environment.js # 环境检查
│   │   └── proxy.js       # 代理服务管理
│   ├── renderer/          # 渲染进程代码
│   │   ├── index.html     # 主界面
│   │   ├── styles.css     # 样式文件
│   │   ├── renderer.js    # 渲染进程逻辑
│   │   └── terminal.js    # 终端管理
│   └── preload/           # 预加载脚本
│       └── preload.js     # 安全桥接
├── assets/                # 静态资源
│   └── icon.png          # 应用图标
├── package.json          # 项目配置
└── README.md             # 项目说明
```

## 功能模块设计

### 1. 环境检查模块
- 检测 Node.js 版本
- 检测 Git 安装状态
- 检测 UV 包管理器
- 检测 Claude Code 安装状态
- 提供一键安装功能

### 2. 配置管理模块
- 创建/编辑/删除配置
- 配置数据加密存储
- 支持多配置切换
- 配置导入/导出功能

### 3. 终端集成模块
- 使用 xterm.js 实现终端模拟
- 支持终端尺寸自适应
- 支持复制/粘贴功能
- 支持终端日志保存

### 4. 代理服务模块
- 自动配置代理服务
- 支持自定义端口
- 代理状态监控
- 错误处理和重试机制

### 5. UI 界面模块
- PuTTY 风格设计
- 深色主题
- 响应式布局
- 状态栏显示

## 安全考虑

### API Key 管理
- 使用 electron-store 加密存储
- 不在日志中记录敏感信息
- 支持 API Key 验证

### 进程隔离
- 主进程和渲染进程严格隔离
- 使用 contextBridge 进行安全通信
- 禁用 nodeIntegration

### 网络安全
- 支持 HTTPS 代理
- 验证 API 端点
- 防止注入攻击

## 性能优化

### 启动优化
- 延迟加载非关键模块
- 使用异步操作
- 缓存环境检查结果

### 内存管理
- 及时释放终端实例
- 限制日志缓存大小
- 定期清理临时文件

### 渲染优化
- 使用虚拟滚动
- 防抖和节流
- 减少重绘重排

## 错误处理

### 错误分类
- 环境错误：缺少依赖
- 配置错误：无效配置
- 网络错误：连接失败
- 运行时错误：进程崩溃

### 错误处理策略
- 友好的错误提示
- 自动重试机制
- 错误日志记录
- 降级处理方案

## 测试要求

### 单元测试
- 核心功能模块测试
- 工具函数测试
- 配置管理测试

### 集成测试
- 环境检查流程
- 配置创建流程
- 代理启动流程

### E2E 测试
- 完整使用流程测试
- 错误场景测试
- 性能测试

## 构建和发布

### 构建配置
- 应用签名
- 自动更新支持
- 多平台构建

### 发布流程
1. 版本号更新
2. 构建测试
3. 生成发布包
4. 创建发布说明

## 版本管理

遵循语义化版本规范：
- MAJOR: 不兼容的 API 修改
- MINOR: 向下兼容的功能性新增
- PATCH: 向下兼容的问题修正

## 品牌要求

- 应用名称：Miaoda
- 移除所有 aicode 相关信息
- 使用自定义图标和品牌标识
- 保持专业简洁的设计风格